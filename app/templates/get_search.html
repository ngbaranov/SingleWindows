{% extends 'base.html' %}
{% block title %}Поиск{% endblock %}
{% block content %}
<div class="container my-5">
    <div class="border p-4 rounded mb-3">
        <h2>Результаты поиска</h2>
        {% if q %}
        <p class="text-muted">Поиск по запросу: <strong>"{{ q }}"</strong></p>
        {% endif %}

        {% if rows %}
            {% for row in rows %}
            <div class="card my-3">
                <div class="card-body">
                    <div class="d-flex justify-content-between align-items-start">
                        <div class="flex-grow-1">
                            <h5 class="card-title">
                                <a href="/user/{{ row.user_id }}" class="text-decoration-none">
                                    {{ row.surname }} {{ row.name }} {{ row.last_name }}
                                </a>
                            </h5>
                            {% if row.description %}
                            <p class="card-text">{{ row.description }}</p>
                            {% endif %}
                            {% if row.date_violation %}
                            <small class="text-muted">
                                Дата нарушения: {{ row.date_violation.strftime('%d.%m.%Y') if row.date_violation else 'Не указана' }}
                            </small>
                            {% endif %}
                        </div>
                        <div class="text-end">
                            <span class="badge bg-info">
                                Релевантность: {{ "%.1f"|format(row.score * 100) }}%
                            </span>
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
        {% else %}
            <div class="alert alert-info" role="alert">
                <h4 class="alert-heading">Ничего не найдено</h4>
                <p>По вашему запросу не найдено ни одного нарушения.</p>
                <hr>
                <p class="mb-0">Попробуйте изменить поисковый запрос или использовать другие ключевые слова.</p>
            </div>
        {% endif %}
    </div>
</div>
{% endblock %}
